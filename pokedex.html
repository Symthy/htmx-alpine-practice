<!DOCTYPE html>
<html lang="ja" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>åˆä»£ãƒã‚±ãƒ¢ãƒ³å›³é‘‘ - HTMX + Alpine.js</title>

    <!-- Tailwind CSS + DaisyUI -->
    <link href="./dist/output.css" rel="stylesheet" />

    <!-- HTMX -->
    <script src="https://unpkg.com/htmx.org@1.9.12"></script>

    <!-- Alpine.js -->
    <script
      defer
      src="https://unpkg.com/alpinejs@3.13.8/dist/cdn.min.js"
    ></script>

    <script>
      document.addEventListener("alpine:init", () => {
        Alpine.store("pokedex", {
          showDetail: false,
          currentTheme: "light",
          showToast: false,
          toastMessage: "",
          clearDetail() {
            document.getElementById("pokemon-detail").innerHTML = "";
            this.showDetail = false;
            this.showToastMessage("è©³ç´°ç”»é¢ã‚’é–‰ã˜ã¾ã—ãŸ", "info");
          },
          showPokemonDetail() {
            this.showDetail = true;
          },
          showToastMessage(message, type = "success") {
            this.toastMessage = message;
            this.showToast = true;
            setTimeout(() => {
              this.showToast = false;
            }, 3000);
          },
          setTheme(theme) {
            this.currentTheme = theme;
            document.documentElement.setAttribute("data-theme", theme);
            localStorage.setItem("theme", theme);
            this.showToastMessage(
              `ãƒ†ãƒ¼ãƒã‚’ã€Œ${theme}ã€ã«å¤‰æ›´ã—ã¾ã—ãŸ`,
              "success"
            );
          },
          init() {
            const savedTheme = localStorage.getItem("theme") || "light";
            this.setTheme(savedTheme);
          },
        });
      });
    </script>
  </head>
  <body class="min-h-screen bg-base-200">
    <!-- ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ -->
    <div
      class="toast toast-top toast-end z-50"
      x-show="$store.pokedex.showToast"
      x-transition
    >
      <div class="alert alert-success">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="stroke-current shrink-0 h-6 w-6"
          fill="none"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
          />
        </svg>
        <span x-text="$store.pokedex.toastMessage"></span>
      </div>
    </div>

    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ -->
    <div
      class="navbar bg-gradient-to-r from-primary to-secondary text-primary-content shadow-xl"
      x-data="{ searchQuery: '' }"
      x-init="$store.pokedex.init()"
    >
      <div class="navbar-start">
        <div class="dropdown">
          <div
            tabindex="0"
            role="button"
            class="btn btn-ghost text-white lg:hidden"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-6 w-6"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h8m-8 6h16"
              />
            </svg>
          </div>
          <ul
            tabindex="0"
            class="menu menu-sm dropdown-content mt-3 z-[1] p-2 shadow bg-base-100 rounded-box w-52"
          >
            <li>
              <a href="#" @click="location.reload()" class="text-base-content"
                >ğŸ  å›³é‘‘ä¸€è¦§</a
              >
            </li>
            <li>
              <a
                href="#"
                @click="$store.pokedex.clearDetail()"
                x-show="$store.pokedex.showDetail"
                class="text-base-content"
                >âŒ è©³ç´°ã‚’é–‰ã˜ã‚‹</a
              >
            </li>
          </ul>
        </div>
        <a
          class="btn btn-ghost text-white text-xl font-bold"
          href="#"
          @click="location.reload()"
        >
          âš¡ åˆä»£ãƒã‚±ãƒ¢ãƒ³å›³é‘‘
        </a>
      </div>

      <div class="navbar-center hidden lg:flex">
        <ul class="menu menu-horizontal px-1">
          <li>
            <a
              href="#"
              @click="location.reload()"
              class="text-white hover:bg-white/20"
              >ğŸ  å›³é‘‘ä¸€è¦§</a
            >
          </li>
          <li>
            <a
              href="#"
              @click="$store.pokedex.clearDetail()"
              x-show="$store.pokedex.showDetail"
              class="text-white hover:bg-white/20"
              >âŒ è©³ç´°ã‚’é–‰ã˜ã‚‹</a
            >
          </li>
        </ul>
      </div>

      <div class="navbar-end gap-2">
        <!-- ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆ -->
        <div class="dropdown dropdown-end">
          <div
            tabindex="0"
            role="button"
            class="btn btn-ghost text-white hover:bg-white/20"
          >
            ğŸ¨
            <span
              x-text="$store.pokedex.currentTheme"
              class="hidden sm:inline capitalize"
            ></span>
          </div>
          <ul
            tabindex="0"
            class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-40"
          >
            <li>
              <button
                type="button"
                class="w-full text-left"
                @click="$store.pokedex.setTheme('light')"
                :class="{ 'active': $store.pokedex.currentTheme === 'light' }"
              >
                â˜€ï¸ ãƒ©ã‚¤ãƒˆ
              </button>
            </li>
            <li>
              <button
                type="button"
                class="w-full text-left"
                @click="$store.pokedex.setTheme('dark')"
                :class="{ 'active': $store.pokedex.currentTheme === 'dark' }"
              >
                ğŸŒ™ ãƒ€ãƒ¼ã‚¯
              </button>
            </li>
            <li>
              <button
                type="button"
                class="w-full text-left"
                @click="$store.pokedex.setTheme('cupcake')"
                :class="{ 'active': $store.pokedex.currentTheme === 'cupcake' }"
              >
                ğŸ§ ã‚«ãƒƒãƒ—ã‚±ãƒ¼ã‚­
              </button>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <!-- æ¤œç´¢ãƒãƒ¼ (ç‹¬ç«‹) -->
    <div class="bg-base-100 shadow-lg border-b" x-data="{ searchQuery: '' }">
      <div class="container mx-auto p-4">
        <div class="flex justify-center">
          <div class="join w-full max-w-lg">
            <input
              type="text"
              placeholder="ğŸ” ãƒã‚±ãƒ¢ãƒ³ã‚’æ¤œç´¢ (ä¾‹: ãƒ”ã‚«ãƒãƒ¥ã‚¦ã€pikachu)"
              class="input input-bordered join-item flex-1 text-lg"
              x-model="searchQuery"
              @input.debounce.500ms="
                if (searchQuery.length > 0) {
                  htmx.ajax('GET', `/api/search?q=${encodeURIComponent(searchQuery)}`, {target: '#search-results', swap: 'innerHTML'});
                  document.getElementById('pokemon-grid').style.display = 'none';
                  document.getElementById('search-results').style.display = 'block';
                } else {
                  document.getElementById('search-results').style.display = 'none';
                  document.getElementById('pokemon-grid').style.display = 'grid';
                }
              "
            />
            <button
              class="btn btn-primary join-item px-6"
              @click="
                if (searchQuery.length > 0) {
                  htmx.ajax('GET', `/api/search?q=${encodeURIComponent(searchQuery)}`, {target: '#search-results', swap: 'innerHTML'});
                  document.getElementById('pokemon-grid').style.display = 'none';
                  document.getElementById('search-results').style.display = 'block';
                }
              "
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="m21 21-6-6m2-5a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"
                />
              </svg>
              æ¤œç´¢
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="container mx-auto p-6">
      <!-- ãƒ˜ãƒƒãƒ€ãƒ¼æƒ…å ± -->
      <div
        class="hero bg-gradient-to-r from-primary/10 to-secondary/10 rounded-xl shadow-lg mb-8 border border-primary/20"
      >
        <div class="hero-content text-center py-8">
          <div class="max-w-2xl">
            <h1 class="text-4xl font-bold text-primary mb-4">
              âš¡ åˆä»£ãƒã‚±ãƒ¢ãƒ³å›³é‘‘
            </h1>
            <p class="text-lg text-base-content/70 mb-6">
              æ‡ã‹ã—ã®åˆä»£ãƒã‚±ãƒ¢ãƒ³ï¼ˆNo.001ã€œ151ï¼‰ã®è©³ç´°æƒ…å ±ã‚’ç¢ºèª<br />
              <span class="badge badge-primary badge-outline"
                >æ—¥æœ¬èªåæ¤œç´¢å¯¾å¿œ</span
              >
              <span class="badge badge-secondary badge-outline"
                >è‹±èªåæ¤œç´¢å¯¾å¿œ</span
              >
            </p>
            <div class="stats bg-base-100 shadow-md border border-primary/20">
              <div class="stat place-items-center">
                <div class="stat-title text-primary font-semibold">
                  ç™»éŒ²ãƒã‚±ãƒ¢ãƒ³æ•°
                </div>
                <div class="stat-value text-3xl text-primary">151</div>
                <div class="stat-desc text-secondary">Generation I</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º -->
      <div class="htmx-indicator flex justify-center p-8">
        <span class="loading loading-spinner loading-lg text-primary"></span>
      </div>

      <!-- æ¤œç´¢çµæœ -->
      <div id="search-results" class="mb-8" style="display: none">
        <!-- æ¤œç´¢çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
      </div>

      <!-- ãƒã‚±ãƒ¢ãƒ³è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ« -->
      <div id="pokemon-detail" class="mb-8">
        <!-- ãƒã‚±ãƒ¢ãƒ³ã®è©³ç´°ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
      </div>

      <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ -->
      <div class="htmx-indicator">
        <div class="flex justify-center items-center py-8">
          <span class="loading loading-spinner loading-lg text-primary"></span>
          <span class="ml-4 text-lg">ãƒã‚±ãƒ¢ãƒ³ã‚’èª­ã¿è¾¼ã¿ä¸­...</span>
        </div>
      </div>

      <!-- ãƒã‚±ãƒ¢ãƒ³ä¸€è¦§ã‚°ãƒªãƒƒãƒ‰ -->
      <div
        id="pokemon-grid"
        class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6"
        hx-get="/api/pokemon?page=1"
        hx-trigger="load"
        hx-indicator=".htmx-indicator"
      >
        <!-- ã‚¹ã‚±ãƒ«ãƒˆãƒ³ãƒ­ãƒ¼ãƒ€ãƒ¼ -->
        <div class="card bg-base-100 shadow-lg animate-pulse">
          <figure class="px-4 pt-4">
            <div class="skeleton w-24 h-24 rounded-xl"></div>
          </figure>
          <div class="card-body p-4 text-center">
            <div class="skeleton h-4 w-16 mx-auto mb-2"></div>
            <div class="skeleton h-6 w-20 mx-auto mb-4"></div>
            <div class="flex justify-center gap-1">
              <div class="skeleton h-5 w-12"></div>
              <div class="skeleton h-5 w-12"></div>
            </div>
          </div>
        </div>
        <!-- ãƒã‚±ãƒ¢ãƒ³ã‚«ãƒ¼ãƒ‰ãŒã“ã“ã«å‹•çš„ã«èª­ã¿è¾¼ã¾ã‚Œã¾ã™ -->
      </div>
    </div>

    <!-- ãƒ•ãƒƒã‚¿ãƒ¼ -->
    <footer
      class="footer footer-center p-10 bg-base-200 text-base-content mt-16"
    >
      <aside>
        <div class="flex items-center gap-2">
          <span class="text-2xl">ğŸ”´</span>
          <p class="font-bold">
            åˆä»£ãƒã‚±ãƒ¢ãƒ³å›³é‘‘ <br />HTMX + Alpine.js + DaisyUI
          </p>
        </div>
        <p>
          ãƒ‡ãƒ¼ã‚¿æä¾›:
          <a href="https://pokeapi.co/" class="link" target="_blank">PokÃ©API</a>
        </p>
        <p>Copyright Â© 2024 - All rights reserved</p>
      </aside>
    </footer>

    <style>
      .htmx-indicator {
        opacity: 0;
        transition: opacity 200ms ease-in;
      }
      .htmx-request .htmx-indicator {
        opacity: 1;
      }
      .htmx-request.htmx-indicator {
        opacity: 1;
      }

      /* ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
      .dropdown-content button {
        display: block;
        width: 100%;
        padding: 0.5rem 1rem;
        text-align: left;
        background: transparent;
        border: none;
        border-radius: 0.5rem;
        cursor: pointer;
        transition: background-color 0.2s;
      }

      .dropdown-content button:hover {
        background-color: hsl(var(--b2));
      }

      .dropdown-content button.active {
        background-color: hsl(var(--p));
        color: hsl(var(--pc));
      }
    </style>
  </body>
</html>
